2024-05-23 10:38:25.570884455 Info Inside the Collect method
2024-05-23 10:38:25.655251342 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:38:25.655338647 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:38:25.655329159 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:38:25.655851228 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:38:25.656457262 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:38:25.656747256 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:38:50.976294179 Info Inside the Collect method
2024-05-23 10:38:51.004652507 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:38:51.004637799 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:38:51.004645437 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:38:51.00500521 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:38:51.004984327 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:38:51.004990064 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:13.869173673 Info Inside the Collect method
2024-05-23 10:41:13.967912165 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:41:13.967892984 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:13.967971568 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:41:13.968072635 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:41:13.968166009 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:41:13.972217264 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:41:18.509680528 Info Inside the Collect method
2024-05-23 10:41:18.538219742 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:41:18.538213367 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:18.538236883 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:41:18.538218065 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:41:18.538433942 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:41:18.539522907 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:41:20.272027448 Info Inside the Collect method
2024-05-23 10:41:20.285938121 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:41:20.285999659 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:20.286898883 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:41:20.286936652 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:41:20.286953525 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:41:20.28878565 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:41:21.915261549 Info Inside the Collect method
2024-05-23 10:41:21.95136797 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:41:21.951369905 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:41:21.951390599 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:41:21.95136952 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:21.951368522 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:41:21.952036783 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:41:23.923647981 Info Inside the Collect method
2024-05-23 10:41:23.994357373 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:41:23.99435302 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:41:23.994344282 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:41:23.994402276 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:41:23.99454536 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:41:23.994989279 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:43:23.998394663 Info Inside the Collect method
2024-05-23 10:43:24.052292032 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:43:24.052289567 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:43:24.052364666 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:43:24.052403221 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:43:24.052407552 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:43:24.052431698 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:43:44.373021181 Info Inside the Collect method
2024-05-23 10:43:44.387219946 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:43:44.387207287 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:43:44.387210939 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:43:44.38722006 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:43:44.388191069 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:43:44.392046788 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:44:10.624886697 Info Inside the Collect method
2024-05-23 10:44:10.637636989 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:44:10.637635382 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:44:10.63765218 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:44:10.637644611 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:44:10.637919064 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:44:10.640728094 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:45:35.758133308 Info Inside the Collect method
2024-05-23 10:45:35.832436032 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:45:35.832645828 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:45:35.832732932 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:45:35.83271358 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:45:35.832790009 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:45:35.839509395 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:45:50.011578761 Info Inside the Collect method
2024-05-23 10:45:50.033728165 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:45:50.033728168 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:45:50.033716765 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:45:50.033751754 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:45:50.033734405 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:45:50.033803271 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:46:02.953109334 Info Inside the Collect method
2024-05-23 10:46:02.967053682 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:46:02.967058315 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:46:02.968508302 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:46:02.968558231 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:46:02.978519185 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:46:02.978529939 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:46:04.729138982 Info Inside the Collect method
2024-05-23 10:46:04.757707936 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:46:04.7577567 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:46:04.757781203 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:46:04.75791918 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:46:04.757947756 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:46:04.758809135 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:46:07.577794521 Info Inside the Collect method
2024-05-23 10:46:07.591862157 Error Error while making connection command Write-Output ("system.disk.free.bytes:" + (Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.DeviceID -eq 'C:'} | Select-Object -ExpandProperty FreeSpace));Write-Output ("system.disk.io.ops.per.second:" + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.idle.time.percent:" + (Get-Counter -Counter "\LogicalDisk(_Total)\% Idle Time").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.bytes.per.sec:"  + (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Read Bytes/sec").CounterSamples.CookedValue);Write-Output ("system.disk.io.queue.length:" + (Get-Counter -Counter "\PhysicalDisk(_total)\Current Disk Queue Length").CounterSamples.CookedValue);Write-Output ("system.disk.io.read.ops.per.sec:" +  (Get-Counter -Counter "\PhysicalDisk(_Total)\Disk Reads/sec").CounterSamples.CookedValue);

2024-05-23 10:46:07.592867933 Error Error while making connection command Write-Output ("system.serial.number:" + (Get-WmiObject Win32_BIOS).SerialNumber);Write-Output ("started.time.seconds:" + (((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime).totalSeconds));Write-Output ("system.logical.processors:" + (Get-WmiObject Win32_ComputerSystem).NumberOfLogicalProcessors);Write-Output ("system.virtual:" +  (Get-WmiObject Win32_ComputerSystem));Write-Output ("system.os.name:" + (Get-WmiObject Win32_OperatingSystem).Caption);Write-Output ("system.model:" + (Get-WmiObject Win32_ComputerSystem).Model);Write-Output ("system.os.service.pack:" + (Get-WMIObject Win32_OperatingSystem).Version);Write-Output ("system.interrupts.per.sec:" + (Get-Counter -Counter "\Processor(_Total)\Interrupts/sec").CounterSamples.CookedValue);Write-Output ("system.vendor:" + (Get-WmiObject -Class Win32_ComputerSystem).Manufacturer);Write-Output ("system.name:" + (Get-WmiObject -Class Win32_ComputerSystem).Name);Write-Output ("system.threads:" + (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).Threads);Write-Output ("system.processor.queue.length:" + (Get-Counter -Counter "\System\Processor Queue Length").CounterSamples.CookedValue);Write-Output ("started.time: "  + ((get-date)- (gcim Win32_OperatingSystem).LastBootUpTime));Write-Output ("system.os.version:" + (Get-WmiObject -Class Win32_OperatingSystem).Version);Write-Output ("system.physical.processors:" +(Get-WmiObject -Class Win32_ComputerSystem).NumberOfProcessors);Write-Output ("system.running.processes:" + (Get-Counter -Counter "\System\Processes").CounterSamples.CookedValue);Write-Output ("system.context.switches.per.sec:" +  (Get-WmiObject -Class Win32_PerfFormattedData_PerfOS_System).ContextSwitchesPerSec);

2024-05-23 10:46:07.592829272 Error Error while making connection command (Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") |  Select-Object -ExpandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.bytes.per.sec';Expression={($_.Sum)}} | fl;Get-WmiObject -Class Win32_LogicalDisk |Select-Object DeviceID, @{Name="UsedBytes"; Expression={[math]::Round(($.Size - $.FreeSpace),3)}} |Measure-Object -Property UsedBytes -Sum  | Select-Object @{Name='system.disk.used.bytes';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\% Idle Time")  | Select-Object -ExpandProperty CounterSamples | Select-Object @{Name='system.disk.io.time.percent';Expression={(100 - $_.CookedValue)}} |  Measure-Object -Property system.disk.io.time.percent -Sum | Select-Object @{Name='system.disk.io.time.percent';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(*)\Disk Writes/sec") | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.disk.io.write.ops.per.sec';Expression={($_.Sum)}} | fl;(Get-Counter -Counter "\PhysicalDisk(_total)\Avg. Disk Bytes/Transfer") | Select-Object -ExpandProperty CounterSamples  | Select-Object @{Name='system.disk.io.bytes.per.sec';Expression={($_.CookedValue)}}  | fl;Get-WmiObject -Class Win32_LogicalDisk | Select-Object -Property @{Label='Total'; expression={($_.Size)}} | Measure-Object -Property Total -Sum | Select-Object @{Name='system.disk.capacity.bytes';Expression={($_.Sum)}}|fl;$diskInfo = Get-WmiObject Win32_LogicalDisk
$totalFreeSpace = ($diskInfo | Measure-Object -Property FreeSpace -Sum).Sum
$totalSize = ($diskInfo | Measure-Object -Property Size -Sum).Sum
$totalFreePercentage = ($totalFreeSpace / $totalSize) * 100
Write-Output "system.disk.free.percent: $totalFreePercentage";$diskInfo = Get-CimInstance -Class Win32_LogicalDisk | 
    Select-Object  @{Label='Used'; expression={($_.Size - $_.FreeSpace)}},@{Label='Total'; expression={($_.Size)}} | 
    Measure-Object -Property Used,Total -Sum

$usedSum = $diskInfo | Where-Object { $_.Property -eq 'Used' } | Select-Object -ExpandProperty Sum
$totalSum = $diskInfo | Where-Object { $_.Property -eq 'Total' } | Select-Object -ExpandProperty Sum

$percentageUsed = ($usedSum / $totalSum) * 100

Write-Output "system.disk.used.percent: $percentageUsed";

2024-05-23 10:46:07.59288705 Error Error while making connection command Write-Output ("memory.free.percent:" + ((Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize)*100);Write-Output ("system.cache.memory.bytes:" +  (Get-WmiObject Win32_PerfFormattedData_PerfOS_Memory).CacheBytes);Write-Output ("memory.used.percent:" + ([Math]::Round(((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory) / (Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize * 100, 2)));Write-Output ("memory.used.bytes:" + ((Get-WmiObject Win32_OperatingSystem).TotalVisibleMemorySize - (Get-WmiObject Win32_OperatingSystem).FreePhysicalMemory));Write-Output ("memory.committed.bytes:" + (Get-Counter -Counter "\Memory\Committed Bytes").CounterSamples.CookedValue);Write-Output ("system.memory.installed.bytes:" + (Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty TotalPhysicalMemory));Write-Output ("system.memory.free.bytes: "  + (Get-Counter -Counter "\Memory\Free & Zero Page List Bytes").CounterSamples.CookedValue);Write-Output ("system.pages.per.sec: "  + (Get-Counter -Counter "\Memory\Pages/sec").CounterSamples.CookedValue);Write-Output ("system.pages.faults.per.sec:"  + (Get-Counter -Counter "\Memory\Page Faults/sec").CounterSamples.CookedValue);Write-Output ("system.non.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Nonpaged Bytes").CounterSamples.CookedValue);Write-Output ("system.paged.memory.bytes:" + (Get-Counter -Counter "\Memory\Pool Paged Bytes").CounterSamples.CookedValue);(Get-Counter -Counter "\Memory\Available Bytes") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.memory.available.bytes';Expression={($_.CookedValue)}} |fl;

2024-05-23 10:46:07.593001826 Error Error while making connection command Get-Counter -Counter "\Network Interface(*)\Output Queue Length" | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.output.queue.length';Expression={($_.Sum)}}| fl;Get-Counter -Counter "\Network Interface(*)\Packets Sent/sec"  | Select-Object -ExpandProperty CounterSamples |  Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.packets.per.sec';Expression={($_.Sum)}} |fl;Get-Counter '\Network Interface(*)\Bytes Total/sec' | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.bytes.per.sec';Expression={($_.Sum)}} |fl;Write-Output ("system.network.tcp.retransmissions:" + (Get-Counter -Counter "\TCPv4\Segments Retransmitted/sec").CounterSamples.CookedValue);Get-Counter "\Network Interface(*)\Bytes Sent/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.out.bytes.per.sec';Expression={($_.Sum)}} |fl;Get-Counter "\Network Interface(*)\Packets Received Errors" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.error.packets';Expression={($_.Sum)}} |fl;Get-Counter -Counter "\Network Interface(*)\Packets Received/sec" | Select-Object -expandProperty CounterSamples  | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.packets.per.sec';Expression={($_.Sum)}} |fl;(Get-Counter -Counter "\Network Interface(*)\Bytes Received/sec" | Select-Object -ExpandProperty CounterSamples | Measure-Object -Property CookedValue -Sum | Select-Object @{Name='system.network.in.bytes.per.sec';Expression={($_.Sum)}} | fl);Write-Output ("system.network.tcp.connections:" +  (Get-Counter -Counter "\TCPv4\Connections Established").CounterSamples.CookedValue);

2024-05-23 10:46:07.594336784 Error Error while making connection command (Get-Counter -Counter "\Processor(_total)\% Idle Time") | Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.idle.percent';Expression={($_.CookedValue)}} | fl;(Get-Counter -Counter "\Processor(_Total)\% Interrupt Time")| Select-Object -ExpandProperty CounterSamples |  Select-Object @{Name='system.cpu.interrupt.percent';Expression={($_.CookedValue)}}  | format-list;Write-Output ("system.cpu.user.percent:"  + (Get-Counter -Counter "\Processor(_Total)\% User Time").CounterSamples.CookedValue);Write-Output ("system.cpu.percent:" + (100- (Get-Counter -Counter "\Processor(_Total)\% Idle Time").CounterSamples.CookedValue));Write-Output ("system.cpu.description:" + (Get-WMIObject -Class Win32_Processor).Description);Write-Output ("systems.cpu.type:" + (Get-WmiObject -Class Win32_Processor).Name);Write-Output ("system.cpu.cores:" + (Get-WmiObject -Class Win32_Processor | Measure-Object -Property NumberOfCores -Sum).Sum);

2024-05-23 10:48:35.244976073 Info Inside the Collect method
2024-05-23 10:48:35.312873633 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:48:35.312873384 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:48:35.312927571 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:48:35.313075954 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:48:35.313347064 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:48:35.314057449 Error Error while making connection :  http response error: 401 - invalid content type
2024-05-23 10:52:30.389135695 Info Inside the Collect method
2024-05-23 10:52:41.779795113 Info ["system.disk.free.bytes:26481631232" "system.disk.io.ops.per.second:16.1200406830138" "system.disk.io.idle.time.percent:99.2841419884831" "system.disk.io.read.bytes.per.sec:0" "system.disk.io.queue.length:0" "system.disk.io.read.ops.per.sec:0"]
2024-05-23 10:52:46.082000129 Info ["system.disk.io.write.bytes.per.sec : 20.2419466627399" "system.disk.used.bytes : 0" "system.disk.io.time.percent : 2.69667909518766" "system.disk.io.write.ops.per.sec : 16.0851636968209" "system.disk.io.bytes.per.sec : 0" "system.disk.capacity.bytes : 85530243072" "system.disk.free.percent: 30.9617163249584" "system.disk.used.percent: 69.0382836750416"]
2024-05-23 10:52:47.129481937 Info ["system.cpu.idle.percent : 9.38844779501787" "system.cpu.interrupt.percent : 0.390618476587941" "system.cpu.user.percent:9.03849781788722" "system.cpu.percent:30.1915687433872" "system.cpu.description:Intel64 Family 6 Model 62 Stepping 4 Intel64 Family 6 Model 62 Stepping 4" "systems.cpu.type:Intel(R) Xeon(R) CPU E5-2658 v2 @ 2.40GHz Intel(R) Xeon(R) CPU E5-2658 v2 @ 2.40GHz" "system.cpu.cores:8"]
2024-05-23 10:52:47.230599076 Info ["system.network.output.queue.length : 0" "system.network.out.packets.per.sec : 11.0235358808446" "system.network.bytes.per.sec : 54674.8410699406" "system.network.tcp.retransmissions:0" "system.network.out.bytes.per.sec : 3967.38467881819" "system.network.error.packets : 0" "system.network.in.packets.per.sec : 238.898549296214" "system.network.in.bytes.per.sec : 55505.2911424726" "system.network.tcp.connections:33"]
2024-05-23 10:53:36.17800717 Info ["system.serial.number:VMware-42 3b a0 7a ae 0d 7a 52-91 9f 08 bc 4c ae 2b 4a" "started.time.seconds:3421603.5848871" "system.logical.processors:8" "system.virtual:\\\\WIN-RC9AF0C6565\\root\\cimv2:Win32_ComputerSystem.Name=\"WIN-RC9AF0C6565\"" "system.os.name:Microsoft Windows Server 2012 R2 Standard" "system.model:VMware Virtual Platform" "system.os.service.pack:6.3.9600" "system.interrupts.per.sec:5038.87035363424" "system.vendor:VMware, Inc." "system.name:WIN-RC9AF0C6565" "system.threads:2642" "system.processor.queue.length:2" "started.time: 39.14:27:42.4448484" "system.os.version:6.3.9600" "system.physical.processors:2" "system.running.processes:170" "system.context.switches.per.sec:19817"]
2024-05-23 10:53:43.239665191 Info ["memory.free.percent:18.6024930615826" "system.cache.memory.bytes:341528576" "memory.used.percent:80.83" "memory.used.bytes:6779856" "memory.committed.bytes:8586838016" "system.memory.installed.bytes:8589393920" "system.memory.free.bytes: 324521984" "system.pages.per.sec: 0" "system.pages.faults.per.sec:268.936366819522" "system.non.paged.memory.bytes:369250304" "system.paged.memory.bytes:353984512" "system.memory.available.bytes : 1686880256"]
